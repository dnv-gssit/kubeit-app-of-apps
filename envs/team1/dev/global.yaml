# global values for logical env
# all of them can be override by region and/or color values

#repoURL:
#targetRevision:
#path:

# sequence values
# - global.yaml # global values
# - we.yaml / eus2.yaml / sea.yaml # region values
# - blue.yaml / green.yaml # color values

applications:
  # list of applications to be deployed in logical env
  # - name: app1
  #   chart: app1
  #   repoURL: https://dnv-gssit.github.io/kubeit-charts
  #   targetRevision: 0.0.1
  #   values:
  #     - global.yaml
  #     - we.yaml
  #     - blue.yaml
  - name: standard-workload
    namespace: standard-test
    values:
      # Workload info
      workload:
        type: standard      # Required - standard or onegateway
        state: stateful     # Required - stateful or stateless, for stateless mounting extra volumes is blocked (besides keyvault)
      
      image:
        repository: "paulbouwer/hello-kubernetes"
        tag: "1.10"
        containerPort: 8080
      
      # service:
      #   port: 8080
      
      defaultRouting:
        enabled: true
        kubeitDefaultHosts:
          hostsPrefix: "www-test"      # Application will be available under: https://${hostsPrefix}-${tenantName}.${env}.kubeit.dnv.com/, instead of https://${app}-${tenantName}.${env}.kubeit.dnv.com/
        rewriteUrlPrefix:
          enabled: false
        allHosts: false
        redirectOnNoTrailingSlash: false
        catchAll: true
      
      authorizationPolicy:
        enabled: false
      requestAuthentication:
        enabled: false
      
      # TODO: add volumes
      # volumes:
      
      # Be Aware! Security contexts configuration is specific to Docker Image, if your workload is not spinning up try disabling settings below and after check what needs to be changed.
      securityContext:
        fsGroup: 1000
        runAsUser: 1000
        runAsNonRoot: true
      
      # readOnlyRootFilesystem should be set as a false because of the issue related to the npm directory creation
      containerSecurityContext:
        capabilities:
          drop:
            - ALL
        readOnlyRootFilesystem: false
        runAsNonRoot: true
      
      # https://github.com/paulbouwer/hello-kubernetes/tree/main/src/app
      env:
        KUBERNETES_NAMESPACE: standard-test
        MESSAGE: "Hello on standard-test namespace!"
      
      resources:
        requests:
          cpu: 50m
          memory: 64Mi
        limits:
          cpu: 300m
          memory: 128Mi
